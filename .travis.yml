language: perl
os:
  - linux

sudo: required
services: 
  - docker

jobs:
  include:
  - env: 
      - DISTRIBUTION=ubuntu
      - DISTRIBUTION_VERSION=18.04
      - DOCKERFILE=Dockerfile.debian.dev

before_script: #Here, we build all testing environments
    #Build image
    - docker build -t engine.dev.$DISTRIBUTION.$DISTRIBUTION_VERSION -f $DOCKERFILE --build-arg IMAGE_NAME=$DISTRIBUTION:$DISTRIBUTION_VERSION .    
    #Display images
    - docker images -a

script: #Here, we run tests on the container already build
    - docker run engine.dev.$DISTRIBUTION.$DISTRIBUTION_VERSION /bin/sh -c "perl Makefile.PL && make test"; fi